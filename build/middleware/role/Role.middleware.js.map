{"version":3,"file":"Role.middleware.js","names":["_helpers","require","_httpStatusCodes","asyncGeneratorStep","n","t","e","r","o","a","c","i","u","value","done","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","_defineProperty","_toPropertyKey","Object","defineProperty","enumerable","configurable","writable","_toPrimitive","Symbol","toPrimitive","call","TypeError","String","Number","ApiRoleMiddleware","permission","ApiAsyncHelper","AsyncHandlerHelper","_ref","req","res","next","_req$entity","role","entity","user","permissions","PermissionsHelper","getPermissionsByRoleName","includes","status","StatusCodes","FORBIDDEN","json","ApiErrorResponseHelper","getReasonPhrase","_x","_x2","_x3","_default","exports","default"],"sources":["../../../src/middleware/role/Role.middleware.js"],"sourcesContent":["import { ApiAsyncHelper, ApiErrorResponseHelper, PermissionsHelper } from \"@/helpers\";\nimport { getReasonPhrase, StatusCodes } from \"http-status-codes\";\n\nclass ApiRoleMiddleware {\n  static role = (permission) =>\n    ApiAsyncHelper.AsyncHandlerHelper(async (req, res, next) => {\n      const role = req?.entity?.user ? \"bold\" : \"ANONYMOUES\";\n      const permissions = await new PermissionsHelper().getPermissionsByRoleName(role);\n      if (permissions.includes(permission)) {\n        return next();\n      }\n\n      return res\n        .status(StatusCodes.FORBIDDEN)\n        .json(\n          new ApiErrorResponseHelper(\n            StatusCodes.FORBIDDEN,\n            \"Access denied! you don't have permission to access this route\",\n            getReasonPhrase(StatusCodes.FORBIDDEN)\n          )\n        );\n    });\n}\n\nexport default ApiRoleMiddleware;\n"],"mappings":"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","ignoreList":[]}