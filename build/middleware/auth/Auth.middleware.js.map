{"version":3,"file":"Auth.middleware.js","names":["_httpStatusCodes","_interopRequireWildcard","require","_helpers","_config","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","default","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","asyncGeneratorStep","o","c","value","done","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","_defineProperty","_toPropertyKey","enumerable","configurable","writable","_toPrimitive","Symbol","toPrimitive","TypeError","String","Number","ApiAuthMiddleware","ApiAsyncHelper","AsyncHandlerHelper","_ref","req","_res","next","_headers$authorizatio","_headers$authorizatio2","cookies","headers","authorization","includes","ApiErrorResponseHelper","StatusCodes","UNAUTHORIZED","getReasonPhrase","token","replace","decodeToken","JWTHelper","verifyToken","Config","IConfig","ACCESS_TOKEN_SECRET","email","user","_x","_x2","_x3","_default","exports"],"sources":["../../../src/middleware/auth/Auth.middleware.js"],"sourcesContent":["import StatusCodes, { getReasonPhrase } from \"http-status-codes\";\nimport { ApiErrorResponseHelper, ApiAsyncHelper, JWTHelper } from \"@/helpers\";\nimport { Config, IConfig } from \"@/config\";\n\nclass ApiAuthMiddleware {\n  static use = ApiAsyncHelper.AsyncHandlerHelper(async (req, _res, next) => {\n    const { cookies, headers } = req;\n    if (!headers.authorization?.includes(\"Bearer\")) {\n      throw new ApiErrorResponseHelper(\n        StatusCodes.UNAUTHORIZED,\n        \"Unauthorised request! access token is missing\",\n        getReasonPhrase(StatusCodes.UNAUTHORIZED)\n      );\n    }\n    const token = cookies?.[\"token\"] || headers.authorization?.replace(\"Bearer \", \"\");\n    const decodeToken = await JWTHelper.verifyToken(token, Config.get(IConfig.ACCESS_TOKEN_SECRET));\n    const { email } = decodeToken;\n    /** Update the middleware logic as per the requirement */\n    if (!email) {\n      throw new ApiErrorResponseHelper(\n        StatusCodes.UNAUTHORIZED,\n        \"Invalid user access token\",\n        getReasonPhrase(StatusCodes.UNAUTHORIZED)\n      );\n    }\n\n    req.user = {};\n    next();\n  });\n}\n\nexport default ApiAuthMiddleware;\n"],"mappings":"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","ignoreList":[]}