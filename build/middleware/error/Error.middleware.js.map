{"version":3,"file":"Error.middleware.js","names":["_multer","require","_httpStatusCodes","_helpers","_Error","_interopRequireDefault","_config","e","__esModule","default","ownKeys","r","t","Object","keys","getOwnPropertySymbols","o","filter","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","arguments","length","forEach","_defineProperty","getOwnPropertyDescriptors","defineProperties","defineProperty","_toPropertyKey","value","configurable","writable","i","_toPrimitive","Symbol","toPrimitive","call","TypeError","String","Number","ApiErrorMiddleware","errors","_req","res","_next","MulterError","ErrorHelper","capture","error","statusCode","ApiErrorResponseHelper","StatusCodes","INTERNAL_SERVER_ERROR","getReasonPhrase","message","stack","Config","isDev","Log","isProduction","map","err","extensions","stacktrace","response","status","json","_default","exports"],"sources":["../../../src/middleware/error/Error.middleware.js"],"sourcesContent":["import { MulterError } from \"multer\";\nimport { getReasonPhrase, StatusCodes } from \"http-status-codes\";\nimport { ApiErrorResponseHelper, Log } from \"@/helpers\";\nimport ErrorHelper from \"@/helpers/app/Error.helper\";\nimport { Config } from \"@/config\";\n\nclass ApiErrorMiddleware {\n  // eslint-disable-next-line no-unused-vars\n  static use = (errors, _req, res, _next) => {\n    if (errors instanceof MulterError) {\n      return ErrorHelper.capture(errors, res);\n    }\n\n    let error = errors;\n    if (!error.statusCode) {\n      error = new ApiErrorResponseHelper(\n        StatusCodes.INTERNAL_SERVER_ERROR,\n        getReasonPhrase(StatusCodes.INTERNAL_SERVER_ERROR),\n        errors.message,\n        errors.stack\n      );\n    }\n    if (Config.isDev()) {\n      Log.error(error.message, error);\n    }\n    if (Config.isProduction()) {\n      error.errors.map((err) => {\n        if (err.extensions && err.extensions.stacktrace) {\n          err.extensions.stacktrace = [];\n        }\n      });\n    }\n    const response = {\n      ...error\n    };\n    return res.status(error.statusCode).json(response);\n  };\n}\n\nexport default ApiErrorMiddleware;\n"],"mappings":";;;;;;AAAA,IAAAA,OAAA,GAAAC,OAAA;AACA,IAAAC,gBAAA,GAAAD,OAAA;AACA,IAAAE,QAAA,GAAAF,OAAA;AACA,IAAAG,MAAA,GAAAC,sBAAA,CAAAJ,OAAA;AACA,IAAAK,OAAA,GAAAL,OAAA;AAAkC,SAAAI,uBAAAE,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAAA,SAAAG,QAAAH,CAAA,EAAAI,CAAA,QAAAC,CAAA,GAAAC,MAAA,CAAAC,IAAA,CAAAP,CAAA,OAAAM,MAAA,CAAAE,qBAAA,QAAAC,CAAA,GAAAH,MAAA,CAAAE,qBAAA,CAAAR,CAAA,GAAAI,CAAA,KAAAK,CAAA,GAAAA,CAAA,CAAAC,MAAA,WAAAN,CAAA,WAAAE,MAAA,CAAAK,wBAAA,CAAAX,CAAA,EAAAI,CAAA,EAAAQ,UAAA,OAAAP,CAAA,CAAAQ,IAAA,CAAAC,KAAA,CAAAT,CAAA,EAAAI,CAAA,YAAAJ,CAAA;AAAA,SAAAU,cAAAf,CAAA,aAAAI,CAAA,MAAAA,CAAA,GAAAY,SAAA,CAAAC,MAAA,EAAAb,CAAA,UAAAC,CAAA,WAAAW,SAAA,CAAAZ,CAAA,IAAAY,SAAA,CAAAZ,CAAA,QAAAA,CAAA,OAAAD,OAAA,CAAAG,MAAA,CAAAD,CAAA,OAAAa,OAAA,WAAAd,CAAA,IAAAe,eAAA,CAAAnB,CAAA,EAAAI,CAAA,EAAAC,CAAA,CAAAD,CAAA,SAAAE,MAAA,CAAAc,yBAAA,GAAAd,MAAA,CAAAe,gBAAA,CAAArB,CAAA,EAAAM,MAAA,CAAAc,yBAAA,CAAAf,CAAA,KAAAF,OAAA,CAAAG,MAAA,CAAAD,CAAA,GAAAa,OAAA,WAAAd,CAAA,IAAAE,MAAA,CAAAgB,cAAA,CAAAtB,CAAA,EAAAI,CAAA,EAAAE,MAAA,CAAAK,wBAAA,CAAAN,CAAA,EAAAD,CAAA,iBAAAJ,CAAA;AAAA,SAAAmB,gBAAAnB,CAAA,EAAAI,CAAA,EAAAC,CAAA,YAAAD,CAAA,GAAAmB,cAAA,CAAAnB,CAAA,MAAAJ,CAAA,GAAAM,MAAA,CAAAgB,cAAA,CAAAtB,CAAA,EAAAI,CAAA,IAAAoB,KAAA,EAAAnB,CAAA,EAAAO,UAAA,MAAAa,YAAA,MAAAC,QAAA,UAAA1B,CAAA,CAAAI,CAAA,IAAAC,CAAA,EAAAL,CAAA;AAAA,SAAAuB,eAAAlB,CAAA,QAAAsB,CAAA,GAAAC,YAAA,CAAAvB,CAAA,uCAAAsB,CAAA,GAAAA,CAAA,GAAAA,CAAA;AAAA,SAAAC,aAAAvB,CAAA,EAAAD,CAAA,2BAAAC,CAAA,KAAAA,CAAA,SAAAA,CAAA,MAAAL,CAAA,GAAAK,CAAA,CAAAwB,MAAA,CAAAC,WAAA,kBAAA9B,CAAA,QAAA2B,CAAA,GAAA3B,CAAA,CAAA+B,IAAA,CAAA1B,CAAA,EAAAD,CAAA,uCAAAuB,CAAA,SAAAA,CAAA,YAAAK,SAAA,yEAAA5B,CAAA,GAAA6B,MAAA,GAAAC,MAAA,EAAA7B,CAAA;AAElC,MAAM8B,kBAAkB,CAAC;AACvB;AAAAhB,eAAA,CADIgB,kBAAkB,SAET,CAACC,MAAM,EAAEC,IAAI,EAAEC,GAAG,EAAEC,KAAK,KAAK;EACzC,IAAIH,MAAM,YAAYI,mBAAW,EAAE;IACjC,OAAOC,cAAW,CAACC,OAAO,CAACN,MAAM,EAAEE,GAAG,CAAC;EACzC;EAEA,IAAIK,KAAK,GAAGP,MAAM;EAClB,IAAI,CAACO,KAAK,CAACC,UAAU,EAAE;IACrBD,KAAK,GAAG,IAAIE,+BAAsB,CAChCC,4BAAW,CAACC,qBAAqB,EACjC,IAAAC,gCAAe,EAACF,4BAAW,CAACC,qBAAqB,CAAC,EAClDX,MAAM,CAACa,OAAO,EACdb,MAAM,CAACc,KACT,CAAC;EACH;EACA,IAAIC,cAAM,CAACC,KAAK,CAAC,CAAC,EAAE;IAClBC,YAAG,CAACV,KAAK,CAACA,KAAK,CAACM,OAAO,EAAEN,KAAK,CAAC;EACjC;EACA,IAAIQ,cAAM,CAACG,YAAY,CAAC,CAAC,EAAE;IACzBX,KAAK,CAACP,MAAM,CAACmB,GAAG,CAAEC,GAAG,IAAK;MACxB,IAAIA,GAAG,CAACC,UAAU,IAAID,GAAG,CAACC,UAAU,CAACC,UAAU,EAAE;QAC/CF,GAAG,CAACC,UAAU,CAACC,UAAU,GAAG,EAAE;MAChC;IACF,CAAC,CAAC;EACJ;EACA,IAAMC,QAAQ,GAAA5C,aAAA,KACT4B,KAAK,CACT;EACD,OAAOL,GAAG,CAACsB,MAAM,CAACjB,KAAK,CAACC,UAAU,CAAC,CAACiB,IAAI,CAACF,QAAQ,CAAC;AACpD,CAAC;AAAA,IAAAG,QAAA,GAAAC,OAAA,CAAA7D,OAAA,GAGYiC,kBAAkB","ignoreList":[]}